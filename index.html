<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');

        html,
        body {
            margin: 0;
            padding: 0;
            background: transparent;
            overflow: hidden;
            height: auto;
            width: auto;
        }

        .card-container {
            display: inline-block;
            font-family: 'Inter', sans-serif;
            text-align: center;
            padding: 5px;
        }
    </style>
</head>

<body>
    <div class="card-container min-w-[250px]">
        <p class="text-[10px] font-bold text-[#4a9488] uppercase tracking-widest mb-1">Avg. Min to Fall Asleep</p>
        <div class="flex items-center justify-center gap-3">
            <span id="fall-res" class="text-4xl font-extrabold text-slate-800 tracking-tighter">--</span>
            <button onclick="copyToClipboard('fall-res', this)"
                class="bg-slate-100 hover:bg-slate-200 px-2 py-1 rounded text-slate-500 text-[10px] font-bold">
                <i class="fa-regular fa-copy"></i>
            </button>
        </div>
        <p class="text-[10px] text-slate-400 mt-1">Based on <span id="fall-cnt">0</span> entries</p>
    </div>
    <script>
        function calcMin(data) {
            const entries = data.split(',').map(l => l.trim()).filter(l => l !== "" && !isNaN(parseFloat(l)));
            if (entries.length === 0) return;
            const sum = entries.reduce((a, b) => a + parseFloat(b), 0);
            document.getElementById('fall-res').innerText = Math.round(sum / entries.length);
            document.getElementById('fall-cnt').innerText = entries.length;
        }
        function copyToClipboard(id, btn) {
            const val = document.getElementById(id).innerText;
            if (val !== "--") { navigator.clipboard.writeText(val); btn.innerHTML = '<i class="fa-solid fa-check text-green-500"></i>'; setTimeout(() => { btn.innerHTML = '<i class="fa-regular fa-copy"></i>'; }, 2000); }
        }
        const params = new URLSearchParams(window.location.search);
        if (params.has('fallTimes')) calcMin(params.get('fallTimes'));
    </script>
</body>

</html>